def main():
    """Point d'entrÃ©e pipeline"""
    
    # ... tout le code existant ...
    
    # ========== RÃ‰SUMÃ‰ FINAL ==========
    
    execution_time = time.time() - start_total_time  # Ajouter au dÃ©but: start_total_time = time.time()
    
    print("\n" + "=" * 80)
    print("ğŸ‰ TRAITEMENT TERMINÃ‰")
    print("=" * 80)
    print(f"âœ… Fichiers traitÃ©s avec succÃ¨s : {total_files_processed}")
    print(f"âŒ Ã‰checs : {total_failed}")
    print("=" * 80)

    # ========== RAPPORT COMPLET ==========
    
    if total_files_processed > 0 or total_failed > 0:
        try:
            from report_manager import ReportManager
            
            report_manager = ReportManager(spark, config)
            
            # GÃ©nÃ©rer rapport console
            report_manager.generate_full_report(
                total_files_processed=total_files_processed,
                total_failed=total_failed,
                total_tables=len(file_tables_df),
                execution_time=execution_time
            )
            
            # Exporter rapports (optionnel)
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
            report_manager.export_to_json(
                f"{config.volume_base}/reports/report_{timestamp}.json"
            )
            report_manager.export_to_html(
                f"{config.volume_base}/reports/report_{timestamp}.html"
            )
            
        except Exception as e:
            print(f"âš ï¸ Erreur gÃ©nÃ©ration rapport : {e}")
            import traceback
            traceback.print_exc()

    # ========== DASHBOARDS ==========
    
    if total_files_processed > 0:
        try:
            dashboard_manager.display_all_dashboards()
        except Exception as e:
            print(f"âš ï¸ Erreur dashboards : {e}")

    print("\nğŸ¯ Pipeline terminÃ© !")


if __name__ == "__main__":
    start_total_time = time.time()  # â† Ajouter ici
    main()
```

## ğŸ“Š **Exemple de Rapport GÃ©nÃ©rÃ©**
```
================================================================================
ğŸ“Š RAPPORT COMPLET D'EXÃ‰CUTION - WAX PIPELINE
================================================================================

================================================================================
ğŸ“‹ 1. RÃ‰SUMÃ‰ GÃ‰NÃ‰RAL
================================================================================

ğŸ•’ Date d'exÃ©cution    : 2025-10-14 15:30:00
â±ï¸  DurÃ©e totale        : 67.31 secondes (1.12 minutes)
ğŸŒ Environnement       : dev
ğŸ“š Catalogue           : abu_catalog
ğŸ—„ï¸  SchÃ©ma tables       : gdp_poc_dev

ğŸ“Š STATISTIQUES GLOBALES:
   âœ… Fichiers traitÃ©s avec succÃ¨s : 2
   âŒ Fichiers en Ã©chec            : 1
   ğŸ“‹ Tables configurÃ©es           : 1
   ğŸ“ˆ Taux de succÃ¨s               : 66.7%

================================================================================
ğŸ“„ 2. DÃ‰TAILS PAR FICHIER
================================================================================

+----------+---------------------------+------+---------+--------+-------+---------+----------+
|Table     |Fichier                    |Lignes|Colonnes |Erreurs |Statut |DurÃ©e (s)|Heure     |
+----------+---------------------------+------+---------+--------+-------+---------+----------+
|site      |site_20250902_120001.csv   |105628|31       |0       |SUCCESS|32.5     |15:30:00  |
|site      |site_20250906_120001.csv   |105628|31       |0       |SUCCESS|33.2     |15:30:35  |
|site      |site_20251302_120001.csv   |0     |0        |0       |FAILED |0.1      |15:31:00  |
+----------+---------------------------+------+---------+--------+-------+---------+----------+

ğŸ“Š Statistiques des fichiers:
   ğŸ“ˆ Total lignes traitÃ©es : 211,256
   âš ï¸  Total erreurs         : 0
   â±ï¸  DurÃ©e moyenne         : 32.85s
   â±ï¸  DurÃ©e max             : 33.20s

================================================================================
ğŸ—„ï¸  3. DÃ‰TAILS PAR TABLE
================================================================================

ğŸ“‹ Tables crÃ©Ã©es:
----------------

ğŸ“Š site_all
   Lignes          : 211,256
   Colonnes        : 33
   Partitions      : 2
   Dates           : 2025-09-02, 2025-09-06
   Fichiers sources: 2
      - site_20250902_120001
      - site_20250906_120001

ğŸ“Š site_last
   Lignes          : 105,628
   Colonnes        : 33
   Partitions      : 1
   Dates           : 2025-09-06

ğŸ“Š RÃ©sumÃ© tables:
   ğŸ—„ï¸  Nombre de tables       : 2
   ğŸ“ˆ Total lignes           : 316,884
   ğŸ“ Total fichiers sources : 2

================================================================================
âœ… 4. QUALITÃ‰ DES DONNÃ‰ES
================================================================================

   âœ… Aucune erreur de qualitÃ© dÃ©tectÃ©e aujourd'hui

================================================================================
âš¡ 5. PERFORMANCE
================================================================================

ğŸ“Š Performance par table:
+----------+----------+----------+-------+-------+-------+--------+
|table_name|executions|total_rows|avg_dur|min_dur|max_dur|lignes/s|
+----------+----------+----------+-------+-------+-------+--------+
|site      |2         |211256    |32.85  |32.5   |33.2   |6432    |
+----------+----------+----------+-------+-------+-------+--------+

================================================================================
ğŸš¨ 6. ERREURS ET ALERTES
================================================================================

âŒ 1 fichier(s) en Ã©chec:

+----------+---------------------------+---------------------------+----------+
|table_name|filename                   |error_message              |time      |
+----------+---------------------------+---------------------------+----------+
|site      |site_20251302_120001.csv   |Invalid date: Month 13     |15:31:00  |
+----------+---------------------------+---------------------------+----------+

================================================================================
ğŸ’¡ 7. RECOMMANDATIONS
================================================================================

ğŸ“‹ Actions recommandÃ©es:

   1. âš ï¸  1 fichier rejetÃ© - VÃ©rifier la validitÃ© des dates dans les noms de fichiers

ğŸ’¡ Bonnes pratiques:
   1. ExÃ©cuter OPTIMIZE sur les tables volumineuses chaque semaine
   2. ExÃ©cuter VACUUM pour nettoyer les anciennes versions (retention 7 jours)
   3. Surveiller les logs de qualitÃ© quotidiennement
   4. Archiver les fichiers traitÃ©s
   5. VÃ©rifier les dashboards d'observabilitÃ© rÃ©guliÃ¨rement

================================================================================
âœ… Rapport terminÃ©
================================================================================
